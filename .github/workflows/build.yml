---
name: Build

"on":
  pull_request:
    branches: [main]
  schedule:
    - cron: 0 11 * * 0-6

jobs:
  deploy-hm-api-node:
    name: Deploy hm-api-node
    runs-on: ubuntu-22.04
    environment:
      name: production-web
      url: https://www.hongbomiao.com
    timeout-minutes: 10
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Deploy to Heroku
        uses: akhileshns/heroku-deploy@v3.12.13
        with:
          heroku_api_key: ${{secrets.HEROKU_API_KEY}}
          heroku_app_name: production-web
          heroku_email: hongbo.miao@outlook.com
          appdir: api-node
          usedocker: true
