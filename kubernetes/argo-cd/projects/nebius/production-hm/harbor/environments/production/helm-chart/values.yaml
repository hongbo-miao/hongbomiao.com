# https://github.com/goharbor/harbor-helm/blob/main/values.yaml
---
logLevel: info
expose:
  type: ingress
  tls:
    enabled: true
    certSource: secret
    secret:
      secretName: production-hm-harbor-certificate
  ingress:
    hosts:
      core: harbor.hongbomiao.com
    # https://serverfault.com/a/1197875/344438
    className: nginx
    annotations:
      external-dns.alpha.kubernetes.io/hostname: harbor.hongbomiao.com
      nginx.ingress.kubernetes.io/proxy-body-size: "0"
      nginx.ingress.kubernetes.io/ssl-redirect: "true"
externalURL: https://harbor.hongbomiao.com
existingSecretAdminPassword: hm-harbor-secret
existingSecretAdminPasswordKey: HARBOR_ADMIN_PASSWORD
core:
  replicas: 3
  resources:
    requests:
      cpu: 50m
      memory: 128Mi
    limits:
      cpu: 100m
      memory: 256Mi
jobservice:
  replicas: 3
  jobLoggers:
    - stdout
  resources:
    requests:
      cpu: 50m
      memory: 128Mi
    limits:
      cpu: 100m
      memory: 256Mi
portal:
  replicas: 3
  resources:
    requests:
      cpu: 50m
      memory: 128Mi
    limits:
      cpu: 100m
      memory: 256Mi
registry:
  replicas: 3
  registry:
    resources:
      requests:
        cpu: 50m
        memory: 128Mi
      limits:
        cpu: 500m
        memory: 512Mi
  controller:
    resources:
      requests:
        cpu: 50m
        memory: 128Mi
      limits:
        cpu: 100m
        memory: 256Mi
trivy:
  replicas: 1
  resources:
    requests:
      cpu: 200m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 1Gi
redis:
  type: internal
  internal:
    resources:
      requests:
        cpu: 50m
        memory: 128Mi
      limits:
        cpu: 100m
        memory: 256Mi
persistence:
  enabled: true
  resourcePolicy: keep
  persistentVolumeClaim:
    trivy:
      accessMode: ReadWriteOnce
      size: 5Gi
      storageClass: production-hm-harbor-storage-class
    redis:
      accessMode: ReadWriteOnce
      size: 1Gi
      storageClass: production-hm-harbor-storage-class
  imageChartStorage:
    type: s3
    s3:
      region: us-central1
      endpoint: https://storage.us-central1.nebius.cloud
      bucket: production-hm-harbor
      existingSecret: hm-harbor-secret
      # 32 MiB, needs to be a string
      chunksize: "33554432"
database:
  type: external
  external:
    host: private-rw.postgresql-xxxxxxxxxxxxxxxxxx.backbone-xxxxxxxxxxxxxxxxxx.msp.us-central1.nebius.cloud
    port: 5432
    username: harbor_user
    coreDatabase: harbor_db
    existingSecret: hm-harbor-secret
    sslmode: require
